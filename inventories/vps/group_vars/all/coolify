---

# ============
# nickjj.docker
# https://github.com/nickjj/ansible-docker
#=============
docker__channel: ["nightly"]
docker__state: "present"
docker__users: ["{{ user1.username | d('root') }}"]
docker__default_daemon_json: |
  "log-driver": "journald"
docker__daemon_flags:
  - "-H unix://"
docker__daemon_environment: []
  # - "HTTP_PROXY=http://proxy.example.com:80"
  # - "HTTPS_PROXY=https://proxy.example.com:443"
docker__systemd_override: ""
# docker Crons
# `a` removes unused images (useful in production).
# `f` forces it to happen without prompting you to agree.
docker__cron_jobs_prune_flags: "af"
# Control the schedule of the docker system prune.
docker__cron_jobs_prune_schedule: ["0", "0", "*", "*", "0"]
docker__cron_jobs:
  - name: "Docker disk clean up"
    job: "docker system prune -{{ docker__cron_jobs_prune_flags }} > /dev/null 2>&1"
    schedule: "{{ docker__cron_jobs_prune_schedule }}"
    cron_file: "docker-disk-clean-up"
    user: "{{ (docker__users | first) | d('root') }}"
    state: "present"
# pip dependencies
docker__pip_dependencies:
  - "gcc"
  #- "python{{ '3' if ansible_python.version.major == 3 else '' }}-dev"
  - "python{{ '3' if ansible_python.version.major == 3 else '' }}-pip"
# Pip config
docker__pip_packages: [virtualenv, setuptools, docker]
docker__pip_docker_state: "present"
docker__pip_docker_compose_state: "present"

# =============
# role-coolify
# https://github.com/loic-roux-404/role-coolify/blob/master/defaults/main.yml
# =============
coolify_git_org: loic-roux-404
coolify_version: fix-missing-mongo
coolify_env:
  # Domain where your Coolify instance will be available and reachable.
  # It's the same as you set in Github OAuth App and Github App as <domain>.
  DOMAIN: "{{ ansible_host }}"
  ## Let's Encrypt contact email required
  LETSENCRYPT_EMAIL: "{{ user1.email }}"

  # JWT Token Sign Key for logging you in to Coolify's frontend
  JWT_SIGN_KEY: jwt-key
  # Encryption key for SECRETS - do NOT share it with others!
  SECRETS_ENCRYPTION_KEY: jwt-encrypt-key

  # Mongodb
  # Values in case if you are using our Mongodb installation - CHANGE user and password fields!
  MONGODB_PORT: 27017
  MONGODB_USER: "{{ coolify_mongo.user }}"
  MONGODB_PASSWORD: "{{ coolify_mongo.password }}"
  MONGODB_DB: coolLabs-prod

  # Frontend only variables
  VITE_GITHUB_APP_CLIENTID: "{{ gh_app.clientid }}"
  VITE_GITHUB_APP_NAME: "{{ gh_app.clientid }}"

  # Github OAuth & App secrets and private key - you can get it from Github.
  GITHUB_APP_CLIENT_SECRET: "{{ gh_app.client_secret }}"
  GITHUP_APP_WEBHOOK_SECRET: "{{ gh_app.webhook_secret }}"

  # It should look like this. Newlines breaks with \n
  GITHUB_APP_PRIVATE_KEY: "{{ lookup('unvault', 'files/keys/coolify-loic-roux-404.2021-07-08.private-key.pem') }}"
